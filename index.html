<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>AI ê²½ë ¥ê¸°ìˆ ì„œ ìƒì„±ê¸°</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; }
        input, textarea { width: 100%; margin-bottom: 8px; padding: 6px; }
        button { padding: 10px 15px; margin-right: 10px; cursor: pointer; }
        #result { white-space: pre-wrap; background: #f7f7f7; padding: 15px; margin-top: 20px; border-radius: 6px; }
    </style>
</head>
<body>

<h2>AI ê²½ë ¥ê¸°ìˆ ì„œ ìƒì„±ê¸°</h2>

<div id="experiences"></div>

<button id="add">ê²½í—˜ ì¶”ê°€í•˜ê¸°</button>
<button id="submit">ê²½ë ¥ê¸°ìˆ ì„œ ìƒì„±</button>

<div id="result"></div>

<script>
// ğŸ”¥ ë°±ì—”ë“œ URL (ì ˆëŒ€ ìˆ˜ì • í•„ìš” ì—†ìŒ)
const API_URL = "https://career-backend-1-mkok.onrender.com/generate";

let container = document.getElementById("experiences");

// ê²½í—˜ ì…ë ¥ ë°•ìŠ¤ ì¶”ê°€
function addExp() {
  let box = document.createElement("div");
  box.innerHTML = `
    <h3>ê²½í—˜</h3>
    <input placeholder="ê²½í—˜ ì œëª©" class="title">
    <textarea placeholder="ë¬¸ì œ" class="problem"></textarea>
    <textarea placeholder="ë‚˜ì˜ ì—­í• " class="role"></textarea>
    <textarea placeholder="ì „ëµ" class="strategy"></textarea>
    <textarea placeholder="ì•¡ì…˜" class="action"></textarea>
    <textarea placeholder="ê²°ê³¼" class="result"></textarea>
    <hr>
  `;
  container.appendChild(box);
}

document.getElementById("add").onclick = addExp;
addExp(); // ì²« ë°•ìŠ¤ ê¸°ë³¸ ìƒì„±

// ê²½ë ¥ê¸°ìˆ ì„œ ìƒì„± ë²„íŠ¼ í´ë¦­
document.getElementById("submit").onclick = async () => {
  document.getElementById("result").textContent = "â³ AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...";

  const exps = [...document.querySelectorAll("#experiences > div")].map(box => ({
    title: box.querySelector(".title").value,
    problem: box.querySelector(".problem").value,
    role: box.querySelector(".role").value,
    strategy: box.querySelector(".strategy").value,
    action: box.querySelector(".action").value,
    result: box.querySelector(".result").value,
  }));

  try {
    const res = await fetch(API_URL, {
      method:"POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ experiences: exps })
    });

    if (!res.ok) {
      throw new Error("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: " + res.status);
    }

    const data = await res.json();
    document.getElementById("result").textContent =
      "ğŸ‰ ê²½ë ¥ê¸°ìˆ ì„œ ìƒì„± ì™„ë£Œ!\n\n" + JSON.stringify(data, null, 2);

  } catch (err) {
    document.getElementById("result").textContent =
      "âŒ ì„œë²„ ì˜¤ë¥˜: " + err.message + "\n\në°±ì—”ë“œë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”.";
  }
};
</script>

</body>
</html>
